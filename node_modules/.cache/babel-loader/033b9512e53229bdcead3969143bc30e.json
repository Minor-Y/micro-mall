{"ast":null,"code":"import api from '../../../api/index';\nimport MinorDialog from '../../components/M-Dialog.vue';\nimport { transformTime } from '../../filters/index';\nexport default {\n  components: {\n    MinorDialog: MinorDialog\n  },\n\n  data() {\n    return {\n      orderQuery: {\n        query: '',\n        pagenum: 1,\n        pagesize: 10,\n        value: 'goodsName'\n      },\n      orderList: [],\n      options: [{\n        value: 'memberName',\n        label: '客户姓名'\n      }, {\n        value: 'orderNum',\n        label: '订单号'\n      }, {\n        value: 'goodsName',\n        label: '商品名'\n      }],\n      value: 'goodsName',\n      total: 0,\n      visibleFlag: false,\n      title: '订单详情',\n      width: '70%',\n      cradWidthHeight: 'width: 100%; height:260px',\n      showCard: {\n        one: true,\n        two: true,\n        three: true,\n        four: true\n      },\n      orderDetails: [],\n      activities: [],\n      consumerInfo: []\n    };\n  },\n\n  created() {\n    this.getOrderList();\n  },\n\n  methods: {\n    async getOrderList() {\n      const {\n        data: res\n      } = await this.$axios.get(`${api.localUrl}/order`, {\n        params: this.orderQuery\n      });\n      if (res.status !== 200) return this.$message.error('获取订单列表失败，请刷新重试');\n      this.orderList = res.data;\n      this.total = res.total;\n      console.log(res.data);\n    },\n\n    handleSizeChange(size) {\n      this.orderQuery.pagesize = size;\n      this.getOrderList();\n    },\n\n    handleCurrentChange(curr) {\n      this.orderQuery.pagenum = curr;\n      this.getOrderList();\n    },\n\n    getType(val) {\n      this.orderQuery.value = val;\n    },\n\n    showOrderDialog(details) {\n      this.visibleFlag = true;\n      this.orderDetails = details;\n      this.consumerInfo.push(details);\n      console.log(details);\n\n      if (details.orderTime) {\n        if (details.payTime) {\n          this.activities.push({\n            content: '下单时间',\n            timestamp: transformTime(details.orderTime)\n          }, {\n            content: '支付时间',\n            timestamp: transformTime(details.payTime),\n            type: 'primary'\n          });\n        } else {\n          this.activities.push({\n            content: '下单时间',\n            timestamp: transformTime(details.orderTime),\n            type: 'primary'\n          });\n        }\n      }\n    },\n\n    // 在关闭对话框的时候清空数组信息\n    clearActivities(arr) {\n      this.activities = arr;\n    },\n\n    clearConsumerInfo(ar) {\n      this.consumerInfo = ar;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA4HA;AACA;AACA;AACA;EACAA;IACAC;EADA,CADA;;EAIAC;IACA;MACAC;QACAC,SADA;QAEAC,UAFA;QAGAC,YAHA;QAIAC;MAJA,CADA;MAOAC,aAPA;MAQAC,UACA;QACAF,mBADA;QAEAG;MAFA,CADA,EAKA;QACAH,iBADA;QAEAG;MAFA,CALA,EASA;QACAH,kBADA;QAEAG;MAFA,CATA,CARA;MAsBAH,kBAtBA;MAuBAI,QAvBA;MAwBAC,kBAxBA;MAyBAC,aAzBA;MA0BAC,YA1BA;MA2BAC,4CA3BA;MA4BAC;QACAC,SADA;QAEAC,SAFA;QAGAC,WAHA;QAIAC;MAJA,CA5BA;MAkCAC,gBAlCA;MAmCAC,cAnCA;MAoCAC;IApCA;EAsCA,CA3CA;;EA4CAC;IACA;EACA,CA9CA;;EA+CAC;IACA;MACA;QAAAvB;MAAA;QACAwB;MADA;MAGA,wBACA;MACA;MACA;MACAC;IACA,CAVA;;IAWAC;MACA;MACA;IACA,CAdA;;IAeAC;MACA;MACA;IACA,CAlBA;;IAmBAC;MACA;IACA,CArBA;;IAsBAC;MACA;MACA;MACA;MACAJ;;MACA;QACA;UACA,qBACA;YACAK,eADA;YAEAC;UAFA,CADA,EAKA;YACAD,eADA;YAEAC,yCAFA;YAGAC;UAHA,CALA;QAWA,CAZA,MAYA;UACA;YACAF,eADA;YAEAC,2CAFA;YAGAC;UAHA;QAKA;MACA;IACA,CAhDA;;IAiDA;IACAC;MACA;IACA,CApDA;;IAqDAC;MACA;IACA;;EAvDA;AA/CA","names":["components","MinorDialog","data","orderQuery","query","pagenum","pagesize","value","orderList","options","label","total","visibleFlag","title","width","cradWidthHeight","showCard","one","two","three","four","orderDetails","activities","consumerInfo","created","methods","params","console","handleSizeChange","handleCurrentChange","getType","showOrderDialog","content","timestamp","type","clearActivities","clearConsumerInfo"],"sourceRoot":"src/views/order","sources":["OrderList.vue"],"sourcesContent":["<template>\n  <div>\n    <el-card>\n      <div class=\"order-top\">\n        <el-select v-model=\"value\" placeholder=\"请选择\" size=\"small\" @change=\"getType\">\n          <el-option v-for=\"item in options\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\n          </el-option>\n        </el-select>\n        <el-input placeholder=\"请输入搜索关键词\" v-model=\"orderQuery.query\" size=\"small\" clearable @clear=\"getOrderList\">\n        </el-input>\n        <el-button type=\"primary\" size=\"small\" icon=\"el-icon-search\" @click=\"getOrderList\">搜索</el-button>\n      </div>\n      <!-- table区域 -->\n      <el-table :data=\"orderList\">\n        <el-table-column prop=\"goodsName\" label=\"商品名称\"></el-table-column>\n        <el-table-column prop=\"orderNum\" label=\"订单号\" width=\"240\"></el-table-column>\n        <el-table-column prop=\"price\" label=\"售价\"></el-table-column>\n        <el-table-column prop=\"count\" label=\"数量\"></el-table-column>\n        <el-table-column prop=\"memberName\" label=\"客户姓名\"></el-table-column>\n        <el-table-column prop=\"amount\" label=\"支付金额\"></el-table-column>\n        <el-table-column label=\"操作\">\n          <template slot-scope=\"scope\">\n            <el-link type=\"primary\" :underline=\"false\" @click=\"showOrderDialog(scope.row)\">详情</el-link>\n          </template>\n        </el-table-column>\n      </el-table>\n      <!-- 分页 -->\n      <el-pagination background @size-change=\"handleSizeChange\" @current-change=\"handleCurrentChange\" :current-page=\"orderQuery.pagenum\" :page-sizes=\"[10, 20, 30, 40, 60]\" :page-size=\"orderQuery.pagesize\" layout=\"total, sizes, prev, pager, next, jumper\" :total=\"total\">\n      </el-pagination>\n    </el-card>\n    <!-- 订单详情弹出框 -->\n    <MinorDialog :visibleFlag.sync=\"visibleFlag\" :title=\"title\" :width=\"width\" \n    :cradWidthHeight=\"cradWidthHeight\" :showCard=\"showCard\" @clearActivities=\"clearActivities\" \n    @clearConsumerInfo=\"clearConsumerInfo\">\n      <div slot=\"one\" class=\"left-align\">\n        <p class=\"font-weight-500\">订单信息</p>\n        <el-divider></el-divider>\n        <el-row>\n          <el-col :span=\"24\" class=\"margintop-16\">\n            <span>订单编号:</span>\n            <span>{{orderDetails.orderNum}}</span>\n          </el-col>\n          <el-col :span=\"24\" class=\"margintop-16\">\n            <span>实付金额:</span>\n            <span>{{orderDetails.amount}}</span>\n          </el-col>\n          <el-col :span=\"24\" class=\"margintop-16\">\n            <span>支付方式:</span>\n            <span>{{orderDetails.Payment}}</span>\n          </el-col>\n          <el-col :span=\"24\" class=\"margintop-16\">\n            <span>买家备注:</span>\n            <span>{{orderDetails.buyersNote}}</span>\n          </el-col>\n          <el-col :span=\"24\" class=\"margintop-16\">\n            <span>卖家备注:</span>\n            <span>{{orderDetails.sellerNote}}</span>\n          </el-col>\n        </el-row>\n      </div>\n      <div slot=\"two\" class=\"left-align\">\n        <p class=\"font-weight-500\">订单状态: {{orderDetails.isPay === 1 ? '已支付' : '未支付'}}</p>\n        <el-divider></el-divider>\n        <el-timeline>\n          <el-timeline-item v-for=\"(activity, index) in activities\" :key=\"index\" :timestamp=\"activity.timestamp\" :type=\"activity.type\">\n            {{activity.content}}\n          </el-timeline-item>\n        </el-timeline>\n      </div>\n      <div slot=\"three\" class=\"left-align\">\n        <p class=\"font-weight-500\">配送信息</p>\n        <el-divider></el-divider>\n        <el-row>\n          <el-col :span=\"12\" class=\"margintop-16\">\n            <span>收货地址:</span>\n            <span>{{orderDetails.receiverAddress}}</span>\n          </el-col>\n          <el-col :span=\"12\" class=\"padding-left-23 margintop-16\">\n            <span>运费:</span>\n            <span>{{orderDetails.freight}}</span>\n          </el-col>\n          <el-col :span=\"12\" class=\"margintop-16\">\n            <span>物流公司:</span>\n            <span>{{orderDetails.logisticsCompany}}</span>\n          </el-col>\n          <el-col :span=\"12\" class=\"padding-left-23 margintop-16\">\n            <span>物流单号:</span>\n            <span>{{orderDetails.logisticsSingle}}</span>\n          </el-col>\n        </el-row>\n      </div>\n      <div slot=\"four\" class=\"left-align\">\n        <p class=\"font-weight-500\">消费信息</p>\n        <el-divider></el-divider>\n        <el-table :data=\"consumerInfo\">\n          <el-table-column prop=\"goodsName\" label=\"商品\"></el-table-column>\n          <el-table-column prop=\"price\" label=\"单价\"></el-table-column>\n          <el-table-column prop=\"count\" label=\"数量\"></el-table-column>\n          <el-table-column prop=\"freight\" label=\"运费\"></el-table-column>\n        </el-table>\n        <el-row class=\"consumer-Info\">\n          <el-col class=\"margintop-16\">\n            <span>小计:</span>\n            <span>{{orderDetails.amount}}</span>\n          </el-col>\n          <el-col class=\"margintop-16\">\n            <span>运费:</span>\n            <span>{{orderDetails.freight}}</span>\n          </el-col>\n          <el-col class=\"margintop-16\">\n            <span>{{orderDetails.isPay === 1 ? '付款: ' + orderDetails.Payment : '待支付:'}}</span>\n            <span>{{orderDetails.amount + orderDetails.freight}}</span>\n          </el-col>\n          <el-col class=\"margintop-16\">\n            <span>合计收款:</span>\n            <span>{{orderDetails.amount + orderDetails.freight}}</span>\n          </el-col>\n        </el-row>\n      </div>\n    </MinorDialog>\n  </div>\n</template>\n\n<script>\nimport api from '../../../api/index'\nimport MinorDialog from '../../components/M-Dialog.vue'\nimport { transformTime } from '../../filters/index'\nexport default {\n  components: {\n    MinorDialog: MinorDialog,\n  },\n  data() {\n    return {\n      orderQuery: {\n        query: '',\n        pagenum: 1,\n        pagesize: 10,\n        value: 'goodsName',\n      },\n      orderList: [],\n      options: [\n        {\n          value: 'memberName',\n          label: '客户姓名',\n        },\n        {\n          value: 'orderNum',\n          label: '订单号',\n        },\n        {\n          value: 'goodsName',\n          label: '商品名',\n        },\n      ],\n      value: 'goodsName',\n      total: 0,\n      visibleFlag: false,\n      title: '订单详情',\n      width: '70%',\n      cradWidthHeight: 'width: 100%; height:260px',\n      showCard: {\n        one: true,\n        two: true,\n        three: true,\n        four: true\n      },\n      orderDetails: [],\n      activities: [],\n      consumerInfo: [],\n    }\n  },\n  created() {\n    this.getOrderList()\n  },\n  methods: {\n    async getOrderList() {\n      const { data: res } = await this.$axios.get(`${api.localUrl}/order`, {\n        params: this.orderQuery,\n      })\n      if (res.status !== 200)\n        return this.$message.error('获取订单列表失败，请刷新重试')\n      this.orderList = res.data\n      this.total = res.total\n      console.log(res.data)\n    },\n    handleSizeChange(size) {\n      this.orderQuery.pagesize = size\n      this.getOrderList()\n    },\n    handleCurrentChange(curr) {\n      this.orderQuery.pagenum = curr\n      this.getOrderList()\n    },\n    getType(val) {\n      this.orderQuery.value = val\n    },\n    showOrderDialog(details) {\n      this.visibleFlag = true\n      this.orderDetails = details\n      this.consumerInfo.push(details)\n      console.log(details)\n      if (details.orderTime) {\n        if (details.payTime) {\n          this.activities.push(\n            {\n              content: '下单时间',\n              timestamp: transformTime(details.orderTime),\n            },\n            {\n              content: '支付时间',\n              timestamp: transformTime(details.payTime),\n              type: 'primary',\n            }\n          )\n        } else {\n          this.activities.push({\n            content: '下单时间',\n            timestamp: transformTime(details.orderTime),\n            type: 'primary',\n          })\n        }\n      }\n    },\n    // 在关闭对话框的时候清空数组信息\n    clearActivities(arr) {\n      this.activities = arr\n    },\n    clearConsumerInfo(ar) {\n      this.consumerInfo = ar\n    },\n  },\n}\n</script>\n\n<style lang=\"less\" scoped>\n.left-align {\n  text-align: left;\n}\n.padding-left-23 {\n  padding-left: 23px;\n}\n.margintop-16 {\n  margin-top: 16px;\n}\n.font-weight-500 {\n  font-weight: 500;\n}\n\n.order-top {\n  display: flex;\n  justify-content: flex-start;\n  margin-bottom: 18px;\n  .el-select {\n    width: 120px;\n    margin-right: 8px;\n  }\n  .el-input {\n    width: 284px;\n    margin-right: 4px;\n  }\n}\n.el-pagination {\n  margin-top: 16px;\n  display: flex;\n  justify-content: flex-start;\n}\n::v-deep .el-table th.el-table__cell {\n  background-color: #f5f6f8;\n}\n::v-deep .el-divider--horizontal {\n  height: 2px;\n  margin: 16px 0 2px 0;\n}\n.el-row {\n  .el-col {\n    display: flex;\n    align-items: center;\n    span {\n      margin-right: 12px;\n    }\n  }\n}\n.el-timeline {\n  padding: 0;\n  margin: 18px 0 0 0;\n}\n.consumer-Info {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  .el-col {\n    justify-content: space-between;\n    width: 260px;\n  }\n}\n</style>"]},"metadata":{},"sourceType":"module"}